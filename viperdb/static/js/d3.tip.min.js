// Public - contructs a new tooltip
//
// Returns a tip
d3.svg.tip=function(){function h(h,i){this.ownerSVGElement.appendChild(g);var j=e.apply(this,arguments),l=f.apply(this,arguments),m=d3.select(g),n=this.tagName.toLowerCase(),o,p,q,r,s,t,u,v=d3.select(this.ownerSVGElement),w=d3.select(this),z=d3.select(k("rect")),A=this.ownerSVGElement.getBoundingClientRect(),B=this.getBBox();w.on("mouseout",function(){m.remove()}),m.text(" ").node().appendChild(z.node());var C=m.append("text").text(l).attr("text-anchor","middle").attr("alignment-baseline","middle"),D=C.node().getBBox();D.width=D.width+b*2,D.height=D.height+b*2,z.attr("width",D.width).attr("height",D.height).attr("rx",c).attr("ry",c),C.attr("dx",D.width/2).attr("dy",D.height/2),r=z.node().getBBox(),q=d3.svg.symbol().type("triangle-down").size(d),p=m.append("path").attr("d",q()),t=p.node().getBBox(),u={top:function(){return p.attr("transform","translate("+r.width/2+","+r.height+")"),s=m.node().getBBox(),x=B.x+B.width/2-s.width/2+j[0],y=B.y-s.height+j[1],{x:x,y:y}},bottom:function(){return p.remove(),q=d3.svg.symbol().type("triangle-up").size(d),p=m.append("path").attr("d",q()),t=p.node().getBBox(),p.attr("transform","translate("+r.width/2+","+ -(t.height/2)+")"),s=m.node().getBBox(),x=B.x+B.width/2-s.width/2+j[0],y=B.y+B.height+t.height-j[1],{x:x,y:y}},left:function(){return p.attr("transform","translate("+r.width+","+r.height/2+") rotate(-90)"),s=m.node().getBBox(),x=B.x-t.height/2+j[0],y=B.y+j[1],n=="circle"?(x-=B.width+s.width/2,y-=B.height/2):n=="rect"&&(x-=s.width-t.height/2,y-=s.height/2),{x:x,y:y}},right:function(){return p.attr("transform","translate("+ -(t.height/2)+","+r.height/2+") rotate(90)"),s=m.node().getBBox(),x=B.x+t.height+j[0],y=B.y+j[1],n=="circle"?(x+=B.width,y-=B.height/2):n=="rect"&&(x+=B.width,y-=s.height/2),{x:x,y:y}}},o=u[a](),o.x+s.width>A.width&&(o=u.left()),o.x<0&&(o=u.right());if(a=="left"||a=="right")o.y<0&&(o.y=0),o.y>A.height&&(o.y=A.height);o.y-s.height<0&&a=="top"&&(o=u.bottom(),o.y+=j[1]*2),m.attr("transform","translate("+o.x+","+o.y+")")}function i(){return[0,0]}function j(){return" "}function k(a){return document.createElementNS(d3.ns.prefix.svg,a)}var a="top",b=5,c=2,d=50,e=i,f=j,g=k("g");return h.attr=function(a,b){return arguments.length<2?d3.select(g).attr(a):(d3.select(g).attr(a,b),h)},h.orient=function(b){return arguments.length?(a=b,h):a},h.padding=function(a){return arguments.length?(b=a,h):b},h.cornerRadius=function(a){return arguments.length?(c=a,h):c},h.stemSize=function(a){return arguments.length?(d=a,h):d},h.offset=function(a){return arguments.length?(e=a==null?a:d3.functor(a),h):e},h.text=function(a){return arguments.length?(f=a==null?a:d3.functor(a),h):f},h};